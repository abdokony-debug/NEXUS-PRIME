{
  "file": "main.py",
  "content": "import sys\nfrom core.vector_memory import VectorMemory\nfrom core.cyber_hunter import CyberHunter\nfrom core.neural_engine import NeuralEngine\nfrom loguru import logger\n\n# Configure logging\nlogger.remove()\nlogger.add(sys.stderr, format=\"<green>{time}</green> | <level>{message}</level>\", level=\"INFO\")\n\ndef run_system():\n    logger.info(\"ðŸš€ STARTING NEXUS-PRIME ENGINE (QUOTA MODE)...\")\n\n    try:\n        memory = VectorMemory()\n        hunter = CyberHunter()\n        brain = NeuralEngine()\n    except Exception as e:\n        logger.critical(f\"System Init Failed: {e}\")\n        return\n\n    missions = memory.fetch_active_missions()\n    if not missions:\n        logger.info(\"ðŸ’¤ No active missions found in database.\")\n        return\n\n    logger.info(f\"ðŸ“‹ Found {len(missions)} active missions.\")\n\n    for mission in missions:\n        # Get Target Quota (Default to 5 if not set)\n        target_quota = mission.get('max_leads') or 5\n        leads_acquired = 0\n        \n        logger.info(f\"âš”ï¸ Executing Mission: {mission['name']} | Target: {target_quota} Leads\")\n        \n        # 1. Hunt (Search)\n        raw_leads = hunter.scan_network(\n            keywords=mission['keywords'], \n            region=mission['target_region']\n        )\n        \n        logger.info(f\"ðŸ”Ž Found {len(raw_leads)} raw signals. Processing...\")\n\n        # 2. Analyze & Filter (AI Loop)\n        for lead in raw_leads:\n            # STOP if quota reached\n            if leads_acquired >= target_quota:\n                logger.success(f\"ðŸ›‘ Quota Reached ({target_quota}/{target_quota}). Stopping Mission.\")\n                break\n\n            context = {\n                \"usp\": mission['usp'],\n                \"region\": mission['target_region'],\n                \"link\": mission['product_link']\n            }\n            \n            # Contextual Analysis\n            lead_text = f\"Title: {lead['title']}\\nContent: {lead['snippet']}\"\n            analysis = brain.analyze_intent(lead_text, context)\n\n            # 3. Decision Gate\n            if analysis and analysis['score'] >= 80:\n                lead_data = {\n                    \"campaign_id\": mission['id'],\n                    \"url\": lead['url'],\n                    \"score\": analysis['score'],\n                    \"reason\": analysis['reason'],\n                    \"message\": analysis['draft_message']\n                }\n                \n                memory.store_verified_lead(lead_data)\n                leads_acquired += 1\n                logger.success(f\"âœ… Lead Secured ({leads_acquired}/{target_quota}) | Score: {analysis['score']}\")\n            else:\n                logger.debug(f\"Low Intent ({analysis.get('score', 0)}) - Skipped\")\n        \n        if leads_acquired < target_quota:\n            logger.warning(f\"âš ï¸ Mission finished but only found {leads_acquired}/{target_quota} leads. Try broader keywords.\")\n\n    logger.info(\"ðŸ All Missions Completed.\")\n\nif __name__ == \"__main__\":\n    run_system()"
}
