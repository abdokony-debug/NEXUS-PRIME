async updatePlatformStatus(platform, status, notes = '') {
  try {
    const schema = require('../config/referral-sites-schema');
    const sheetName = schema.sheetName;
    
    const sheet = this.doc.sheetsByTitle[sheetName];
    if (!sheet) return false;
    
    // تحديث خلية الحالة
    const statusCell = sheet.getCell(platform.rowNumber - 1, schema.columns.status);
    statusCell.value = status;
    
    // إضافة ملاحظات في عمود إضافي إذا لزم الأمر
    if (notes && schema.columns.notes !== undefined) {
      const notesCell = sheet.getCell(platform.rowNumber - 1, schema.columns.notes);
      notesCell.value = notes;
    }
    
    await sheet.saveUpdatedCells();
    logger.info(`Updated ${platform.platform} status to ${status}`);
    
    return true;
    
  } catch (error) {
    logger.error(`Failed to update status for ${platform.platform}`, error);
    return false;
  }
}
